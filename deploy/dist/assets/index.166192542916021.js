var R=Object.defineProperty;var B=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var P=(a,l,t)=>l in a?R(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,q=(a,l)=>{for(var t in l||(l={}))G.call(l,t)&&P(a,t,l[t]);if(B)for(var t of B(l))T.call(l,t)&&P(a,t,l[t]);return a};import{_ as I,H as U,k as x,m as L,P as j,p as H,a as A,h as e,w as n,g as J,N as W,M as X,r as i,aC as k,o as s,aD as b,F as Y,e as Z,f as _,b as g,y,i as c,t as $,A as ee,z as te}from"./index.1661925429160.js";import{l as ae,d as oe}from"./api.16619254291602.js";import le from"./editModule.16619254291604.js";const ne={name:"index",components:{EditModule:le},setup(){const{proxy:a}=J(),l=U(),t=x({loading:!0,ids:[],single:!0,multiple:!0,title:"",tableData:[],total:0,methodOptions:[],queryParams:{pageNum:1,pageSize:10,path:void 0,description:void 0,method:void 0,apiGroup:void 0}}),u=()=>{t.loading=!0,ae(t.queryParams).then(o=>{t.tableData=o.data.data,t.total=o.data.total,t.loading=!1})},D=()=>{t.queryParams.path=void 0,t.queryParams.description=void 0,t.queryParams.method=void 0,t.queryParams.apiGroup=void 0,u()},w=o=>{o=[],t.title="\u6DFB\u52A0Api\u53C2\u6570",l.value.openDialog(o)},C=o=>{t.title="\u4FEE\u6539Api\u53C2\u6570",l.value.openDialog(o)},p=o=>{const h=o.id||t.ids;W({message:'\u662F\u5426\u786E\u8BA4\u5220\u9664\u914D\u7F6E\u53C2\u6570\u7F16\u53F7\u4E3A"'+h+'"\u7684\u6570\u636E\u9879?',title:"\u8B66\u544A",showCancelButton:!0,confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(function(){return oe(h).then(()=>{u(),X.success("\u5220\u9664\u6210\u529F")})})},v=o=>{t.ids=o.map(h=>h.id),t.single=o.length!=1,t.multiple=!o.length},E=o=>{t.queryParams.pageSize=o,u()},d=o=>{t.queryParams.pageNum=o,u()};return L(()=>{u(),a.getDicts("sys_method_api").then(o=>{t.methodOptions=o.data}),a.mittBus.on("onEditApiModule",o=>{u()})}),j(()=>{a.mittBus.off("onEditApiModule")}),q({editModuleRef:l,handleSelectionChange:v,handleSizeChange:E,handleCurrentChange:d,handleQuery:u,resetQuery:D,onOpenAddModule:w,onOpenEditModule:C,onTabelRowDel:p},H(t))}},ue={class:"app-container"},re=c(" \u641C\u7D22 "),ie=c(" \u91CD\u7F6E "),de={class:"card-header"},se=g("span",{class:"card-header-text"},"API\u5217\u8868",-1),pe=c(" \u65B0\u589E "),me=c(" \u5220\u9664 "),ce=c(" \u4FEE\u6539 "),he=c(" \u5220\u9664 ");function _e(a,l,t,u,D,w){const C=i("el-input"),p=i("el-form-item"),v=i("el-option"),E=i("el-select"),d=i("SvgIcon"),o=i("el-button"),h=i("el-form"),F=i("el-card"),m=i("el-table-column"),V=i("el-tag"),S=i("el-popover"),M=i("el-table"),z=i("el-divider"),N=i("el-pagination"),K=i("EditModule"),f=k("auth"),O=k("loading");return s(),A("div",ue,[e(F,{shadow:"always"},{default:n(()=>[e(h,{model:a.queryParams,ref:"queryForm",inline:!0},{default:n(()=>[e(p,{label:"\u8DEF\u5F84",prop:"path"},{default:n(()=>[e(C,{placeholder:"Api\u8DEF\u5F84\u6A21\u7CCA\u67E5\u8BE2",clearable:"",onKeyup:b(u.handleQuery,["enter"]),style:{width:"240px"},modelValue:a.queryParams.path,"onUpdate:modelValue":l[0]||(l[0]=r=>a.queryParams.path=r)},null,8,["onKeyup","modelValue"])]),_:1}),e(p,{label:"\u63CF\u8FF0",prop:"description"},{default:n(()=>[e(C,{placeholder:"\u63CF\u8FF0\u6A21\u7CCA\u67E5\u8BE2",clearable:"",onKeyup:b(u.handleQuery,["enter"]),style:{width:"240px"},modelValue:a.queryParams.description,"onUpdate:modelValue":l[1]||(l[1]=r=>a.queryParams.description=r)},null,8,["onKeyup","modelValue"])]),_:1}),e(p,{label:"\u5206\u7EC4",prop:"apiGroup"},{default:n(()=>[e(C,{placeholder:"\u5206\u7EC4\u67E5\u8BE2",clearable:"",onKeyup:b(u.handleQuery,["enter"]),style:{width:"240px"},modelValue:a.queryParams.apiGroup,"onUpdate:modelValue":l[2]||(l[2]=r=>a.queryParams.apiGroup=r)},null,8,["onKeyup","modelValue"])]),_:1}),e(p,{label:"\u65B9\u6CD5",prop:"method"},{default:n(()=>[e(E,{modelValue:a.queryParams.method,"onUpdate:modelValue":l[3]||(l[3]=r=>a.queryParams.method=r),placeholder:"\u65B9\u6CD5",clearable:"",style:{width:"240px"}},{default:n(()=>[(s(!0),A(Y,null,Z(a.methodOptions,r=>(s(),_(v,{key:r.dictValue,label:r.dictLabel,value:r.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,null,{default:n(()=>[e(o,{type:"primary",plain:"",onClick:u.handleQuery},{default:n(()=>[e(d,{name:"elementSearch"}),re]),_:1},8,["onClick"]),e(o,{onClick:u.resetQuery},{default:n(()=>[e(d,{name:"elementRefresh"}),ie]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1}),e(F,{class:"box-card"},{header:n(()=>[g("div",de,[se,g("div",null,[y((s(),_(o,{type:"primary",plain:"",onClick:u.onOpenAddModule},{default:n(()=>[e(d,{name:"elementPlus"}),pe]),_:1},8,["onClick"])),[[f,"system:api:add"]]),y((s(),_(o,{type:"danger",plain:"",disabled:a.multiple,onClick:u.onTabelRowDel},{default:n(()=>[e(d,{name:"elementDelete"}),me]),_:1},8,["disabled","onClick"])),[[f,"system:api:delete"]])])])]),default:n(()=>[y((s(),_(M,{data:a.tableData,onSelectionChange:u.handleSelectionChange},{default:n(()=>[e(m,{type:"selection",width:"55",align:"center"}),e(m,{label:"id",align:"center",prop:"id"}),e(m,{label:"\u8DEF\u5F84",align:"center",prop:"path","show-overflow-tooltip":!0}),e(m,{label:"\u5206\u7EC4",align:"center",prop:"apiGroup"}),e(m,{label:"\u7B80\u4ECB",align:"center",prop:"description"}),e(m,{label:"\u8BF7\u6C42",align:"center",prop:"method","show-overflow-tooltip":!0},{default:n(r=>[e(V,{type:"success"},{default:n(()=>[c($(r.row.method),1)]),_:2},1024)]),_:1}),e(m,{label:"\u64CD\u4F5C",align:"center",width:"200","class-name":"medium-padding fixed-width"},{default:n(r=>[e(S,{placement:"left"},{reference:n(()=>[e(o,{type:"primary",circle:""},{default:n(()=>[e(d,{name:"elementStar"})]),_:1})]),default:n(()=>[g("div",null,[y((s(),_(o,{text:"",type:"primary",onClick:Q=>u.onOpenEditModule(r.row)},{default:n(()=>[e(d,{name:"elementEdit"}),ce]),_:2},1032,["onClick"])),[[f,"system:api:edit"]])]),g("div",null,[r.row.parentId!=0?y((s(),_(o,{key:0,text:"",type:"primary",onClick:Q=>u.onTabelRowDel(r.row)},{default:n(()=>[e(d,{name:"elementDelete"}),he]),_:2},1032,["onClick"])),[[f,"system:api:delete"]]):ee("",!0)])]),_:2},1024)]),_:1})]),_:1},8,["data","onSelectionChange"])),[[O,a.loading]]),y(g("div",null,[e(z),e(N,{background:"",total:a.total,"current-page":a.queryParams.pageNum,"page-size":a.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:u.handleSizeChange,onCurrentChange:u.handleCurrentChange},null,8,["total","current-page","page-size","onSizeChange","onCurrentChange"])],512),[[te,a.total>0]])]),_:1}),e(K,{ref:"editModuleRef",title:a.title},null,8,["title"])])}var ve=I(ne,[["render",_e]]);export{ve as default};
